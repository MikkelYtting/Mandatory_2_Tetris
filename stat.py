import numpy as np
from scipy.stats import ttest_rel, t

# Data from trained model
trained_blocks = [
    364, 886, 5105, 709, 1181, 3697, 3742, 2237, 3960, 1214, 808, 256, 1551, 1108, 823, 1651, 
    327, 693, 306, 512, 360, 370, 486, 1065, 5274, 648, 1226, 1009, 2199, 2172, 524, 619, 351, 181
]

dummy_blocks = [18, 16, 20, 23, 13, 22, 21, 18, 19, 20, 20, 22, 21, 22, 13, 22, 24, 22, 19, 18, 16, 20, 21, 24, 18, 22, 12, 20, 21, 15, 17, 19, 25, 19, 21, 22, 17, 17, 14, 19, 20, 20, 21, 22, 26, 16, 12, 22, 20, 16, 16, 22, 20, 18, 15, 20, 19, 23, 16, 21, 17, 21, 15, 21, 20, 19, 15, 14, 22, 21, 12, 17, 18, 19, 21, 19, 16, 23, 23, 25, 21, 18, 17, 28, 24, 16, 18, 21, 18, 23, 14, 14, 16, 19, 22, 21, 20, 17, 12, 19, 19, 19, 15, 9, 12, 21, 15, 17, 18, 20, 16, 16, 21, 18, 20, 20, 21, 22, 19, 23, 18, 20, 24, 18, 19, 16, 24, 18, 15, 21, 14, 21, 17, 20, 15, 11, 19, 18, 20, 22, 24, 22, 22, 21, 14, 21, 19, 19, 13, 11, 23, 18, 27, 25, 23, 20, 22, 14, 15, 20, 16, 19, 15, 14, 21, 20, 20, 19, 16, 25, 18, 22, 21, 23, 15, 20, 16, 12, 14, 19, 20, 16, 22, 13, 19, 20, 23, 18, 17, 17, 19, 25, 20, 13, 20, 18, 19, 17, 15, 24, 17, 20, 25, 17, 21, 21, 18, 18, 21, 19, 26, 18, 20, 18, 17, 17, 24, 15, 21, 22, 20, 19, 14, 20, 20, 12, 16, 18, 19, 22, 16, 21, 13, 17, 17, 10, 22, 22, 17, 18, 18, 21, 17, 16, 23, 15, 22, 11, 13, 21, 18, 11, 20, 18, 19, 20, 26, 15, 21, 22, 11, 15, 16, 19, 16, 14, 18, 23, 19, 19, 16, 18, 14, 18, 15, 19, 14, 21, 26, 20, 22, 15, 23, 13, 22, 12, 23, 16, 21, 18, 22, 21, 12, 18, 15, 19, 17, 20, 19, 16, 18, 23, 19, 21, 19, 21, 19, 23, 14, 18, 21, 18, 22, 21, 20, 16, 24, 11, 19, 20, 19, 22, 14, 22, 23, 23, 17, 23, 20, 16, 19, 16, 17, 18, 19, 18, 18, 20, 18, 20, 14, 17, 17, 21, 15, 22, 23, 16, 22, 22, 15, 18, 13, 23, 20, 20, 20, 17, 19, 17, 17, 20, 17, 18, 13, 21, 17, 22, 19, 18, 21, 17, 20, 18, 19, 14, 19, 29, 16, 16, 18, 19, 20, 18, 24, 21, 20, 13, 21, 15, 14, 18, 17, 19, 21, 18, 17, 20, 21, 22, 18, 20, 14, 20, 18, 13, 20, 28, 18, 20, 21, 15, 21, 14, 22, 22, 19, 21, 18, 18, 19, 22, 19, 19, 14, 9, 16, 20, 17, 15, 13, 22, 16, 16, 17, 19, 14, 23, 14, 22, 19, 14, 15, 23, 18, 13, 16, 22, 19, 12, 19, 16, 21, 14, 13, 14, 19, 17, 18, 22, 21, 19, 22, 18, 16, 22, 20, 16, 18, 22, 21, 18, 22, 11, 21, 20, 20, 19, 16, 21, 22, 21, 18, 12, 19, 19, 17, 16, 22, 24, 12, 18, 13, 18, 18, 15, 23, 14, 18, 13, 16, 15, 16, 24, 18, 13, 18, 15, 20, 10, 18, 21, 16, 12, 16, 24, 11, 22, 22, 14, 18, 19, 17, 17, 22, 17, 17, 20, 19, 20, 15, 19, 20, 18, 17, 18, 18, 16, 19, 13, 17, 25, 17, 25, 18, 23, 15, 19, 15, 13, 23, 22, 22, 22, 21, 20, 18, 21, 14, 22, 19, 21, 18, 17, 18, 15, 22, 15, 16, 15, 22, 15, 21, 24, 19, 14, 16, 19, 14, 20, 21, 17, 17, 17, 24, 21, 19, 18, 18, 13, 14, 21, 12, 16, 20, 22, 19, 21, 21, 18, 18, 21, 13, 13, 21, 16, 19, 15, 17, 17, 18, 19, 15, 19, 18, 25, 17, 20, 22, 16, 17, 24, 15, 21, 16, 22, 21, 16, 19, 15, 18, 21, 22, 19, 14, 29, 18, 16, 20, 18, 21, 16, 17, 17, 20, 20, 12, 20, 20, 18, 20, 12, 15, 22, 17, 16, 17, 21, 15, 18, 19, 17, 16, 17, 17, 17, 20, 18, 16, 19, 21, 19, 15, 19, 15, 18, 17, 17, 17, 15, 15, 18, 19, 16, 14, 19, 17, 21, 22, 15, 21, 17, 17, 22, 21, 23, 17, 22, 18, 12, 19, 19, 20, 18, 18, 22, 19, 16, 23, 17, 13, 20, 14, 19, 23, 19, 18, 19, 15, 18, 17, 24, 15, 20, 13, 24, 12, 21, 19, 18, 19, 18, 18, 15, 15, 16, 20, 18, 18, 15, 18, 21, 13, 22, 22, 13, 13, 24, 13, 18, 19, 16, 17, 18, 17, 15, 22, 22, 17, 15, 21, 17, 15, 21, 20, 27, 16, 19, 23, 22, 14, 24, 25, 13, 18, 15, 17, 19, 19, 19, 17, 12, 19, 27, 10, 18, 20, 19, 16, 11, 20, 15, 17, 21, 20, 16, 13, 13, 20, 21, 20, 17, 16, 20, 13, 21, 16, 16, 16, 19, 18, 20, 20, 20, 17, 18, 14, 13, 17, 19, 21, 23, 18, 14, 15, 22, 19, 24, 18, 14, 19, 19, 18, 23, 21, 13, 12, 17, 17, 17, 25, 15, 20, 19, 19, 18, 15, 20, 15, 17, 18, 21, 19, 16, 19, 16, 16, 20, 15, 25, 18, 19, 20, 23, 22, 16, 17, 13, 17, 21, 20, 15, 23, 19, 13, 21, 18, 18, 17, 19, 16, 20, 18, 19, 21, 23, 18, 16, 18, 16, 20, 16, 18, 21, 19, 21, 20, 16, 16, 15, 10, 21, 19, 23, 18, 17, 21, 16, 21, 19, 18, 20, 15, 13, 27, 20, 15, 18, 23, 16, 16, 22, 18, 17, 21, 22, 15, 14, 21, 16, 13, 21, 20, 15, 17, 13, 20, 13, 21, 23, 17, 22, 13, 16, 18, 21, 16, 17, 16, 19, 18, 19, 16, 17, 20, 16, 18, 24, 18, 19, 15, 24, 14, 9, 22, 17, 17, 25, 16, 25, 16, 20, 14, 20, 19, 19, 15, 17, 19, 17, 22, 11, 18, 19, 19, 13, 17, 21, 18, 14, 20, 19, 17, 14, 17, 21, 25, 18, 25, 17, 12, 11, 20, 14, 21, 17, 22, 18, 23, 24, 23, 22, 14, 18, 22, 21, 18, 23, 20, 21, 20, 18, 17, 23, 18, 17, 17, 24, 13, 16, 18, 20, 17, 17, 15, 18, 16, 19, 19, 21, 21, 19, 16, 21, 23, 16, 19, 16, 24, 19, 13, 20, 21, 15, 14, 21, 16, 16, 14, 21, 14, 19, 13, 18, 17, 19, 22, 17, 23, 16, 23, 18, 20, 22, 18, 20, 22, 16, 15, 26, 20, 22, 18, 20, 19, 15, 14, 20, 19, 20, 19, 15, 21, 20, 16, 20, 18, 13, 22, 16, 21, 18, 24, 13, 23, 22, 21, 21, 21, 15, 15, 21, 22, 23, 19, 18, 14, 22, 18, 18, 17, 18, 21, 9, 22, 19, 18, 16, 21, 18, 14, 22, 20, 23, 13, 17, 15, 15, 15, 17, 17, 22, 18, 12, 22, 24, 16, 20, 16, 18, 23, 17, 20, 25, 16, 25, 16, 18, 13, 19, 24, 18, 22, 21, 21, 21, 20, 18, 17, 19, 15, 20, 18, 23, 22, 19, 12, 21, 16, 18, 16, 18, 23, 18, 25, 25, 18, 17, 14, 13, 15, 14, 22, 24, 22, 15, 17, 19, 20, 16, 16, 18, 17, 21, 18, 14, 17, 20, 24, 19, 15, 16, 23, 21, 14, 18, 17, 19, 17, 19, 20, 24, 19, 25, 23, 14, 12, 20, 22, 16, 18, 19, 18, 20, 22, 23, 17, 22, 18, 19, 18, 19, 15, 22, 27, 25, 15, 18, 16, 23, 15, 20, 20, 20, 25, 20, 21, 22, 22, 18, 16, 19, 21, 18, 19, 21, 22, 13, 17, 17, 24, 15, 19, 13, 20, 15, 15, 18, 22, 25, 13, 20, 15, 19, 15, 12, 19, 21, 16, 17, 21, 15, 15, 20, 18, 19, 25, 16, 15, 20, 22, 14, 18, 17, 17, 17, 17, 16, 24, 17, 18, 16, 19, 18, 14, 20, 22, 25, 20, 19, 19, 18, 20, 19, 14, 19, 19, 15, 16, 21, 17, 16, 11, 21, 16, 19, 18, 17, 21, 19, 19, 21, 20, 20, 18, 20, 15, 23, 17, 12, 18, 18, 15, 18, 18, 19, 17, 17, 22, 18, 14, 17, 18, 15, 18, 21, 14, 21, 11, 17, 20, 19, 20, 16, 17, 16, 14, 22, 19, 12, 15, 19, 15, 22, 17, 13, 21, 17, 17, 14, 16, 22, 18, 17, 17, 19, 19, 22, 18, 16, 15, 18, 18, 20, 21, 21, 12, 20, 21, 16, 16, 15, 18, 20, 16, 22, 21, 18, 20, 20, 18, 16, 17, 19, 20, 15, 10, 17, 21, 20, 13, 20, 22, 16, 18, 24, 19, 19, 12, 15, 14, 17, 18, 18, 24, 16, 13, 13, 14, 15, 15, 19, 11, 16, 15, 17, 20, 18, 13, 17, 12, 19, 12, 22, 15, 17, 22, 15, 19, 15, 14, 24, 20, 14, 19, 19, 19, 22, 19, 18, 14, 17, 18, 17, 12, 19, 20, 15, 19, 22, 20, 22, 23, 26, 16, 17, 21, 17, 20, 23, 19, 21, 18, 22, 23, 15, 17, 21, 20, 20, 21, 19, 23, 21, 15, 20, 15, 17, 25, 18, 17, 18, 20, 25, 17, 17, 16, 20, 18, 17, 21, 17, 12, 16, 20, 20, 19, 19, 23, 18, 19, 17, 19, 14, 19, 19, 21, 19, 18, 15, 21, 15, 20, 18, 21, 23, 16, 19, 25, 17, 15, 17, 17, 18, 20, 21, 19, 19, 20, 18, 16, 18, 20, 16, 18, 19, 18, 14, 20, 17, 16, 15, 16, 18, 12, 17, 20, 15, 18, 15, 21, 18, 22, 22, 15, 15, 17, 17, 13, 20, 20, 18, 22, 18, 18, 21, 20, 19, 23, 16, 21, 22, 23, 15, 20, 24, 22, 21, 13, 21, 24, 17, 19, 23, 17, 20, 21, 20, 17, 18, 20, 21, 17, 17, 20, 18, 25, 22, 17, 21, 20, 20, 20, 16, 20, 21, 13, 25, 13, 15, 15, 19, 21, 20, 16, 23, 22, 17, 24, 12, 18, 24, 17, 18, 24, 17, 14, 19, 13, 17, 16, 21, 14, 21, 21, 19, 16, 21, 19, 16, 15, 20, 20, 15, 13, 15, 15, 22, 22, 17, 14, 19, 17, 18, 17, 17, 19, 16, 19, 22, 20, 13, 12, 17, 12, 20, 24, 16, 18, 15, 15, 22, 21, 18, 18, 22, 18, 20, 20, 19, 19, 21, 19, 13, 23, 18, 21, 18, 18, 15, 19, 18, 13, 17, 24, 16, 18, 14, 20, 20, 22, 21, 21, 23, 21, 17, 21, 16, 20, 19, 21, 18, 23, 22, 17, 20, 17, 23, 22, 19, 20, 17, 24, 18, 16, 19, 24, 15, 11, 17, 19, 21, 18, 18, 16, 17, 20, 26, 15, 16, 15, 12, 19, 15, 20, 18, 24, 23, 24, 11, 12, 13, 20, 20, 14, 24, 21, 14, 16, 17, 19, 17, 18, 25, 18, 16, 16, 14, 20, 18, 18, 20, 20, 18, 21, 22, 20, 20, 23, 15, 19, 18, 22, 23, 21, 9, 21, 18, 13, 14, 19, 17, 23, 12, 16, 22, 19, 20, 20, 20, 22, 17, 20, 22, 13, 20, 23, 19, 19, 16, 15, 12, 15, 20, 12, 14, 15, 15, 17, 20, 20, 21, 21, 23, 19, 20, 19, 16, 15, 14, 21, 20, 18, 20, 16, 16, 23, 20, 15, 27, 20, 20, 20, 12, 16, 16, 15, 11, 14, 19, 21, 14, 13, 17, 16, 16, 18, 21, 20, 19, 21, 15, 21, 23, 14, 22, 14, 16, 26, 19, 20, 21, 24, 18, 16, 20, 13, 15, 18, 17, 15, 25, 19, 19, 19, 17, 22, 16, 23, 18, 15, 23, 15, 19, 21, 16, 20, 21, 20, 19, 16, 16, 17, 16, 21, 24, 22, 20, 22, 14, 12, 11, 21, 18, 17, 18, 20, 21, 14, 13, 21, 19, 19, 19, 18, 21, 17, 18, 17, 18, 19, 20, 17, 16, 21, 18, 18, 22, 17, 21, 18, 18, 15, 21, 21, 24, 18, 19, 16, 21, 17, 18, 12, 21, 14, 24, 19, 18, 24, 15, 23, 19, 15, 18, 23, 21, 22, 15, 12, 24, 14, 20, 18, 16, 17, 13, 19, 19, 19, 21, 19, 19, 15, 18, 19, 17, 21, 21, 17, 19, 14, 17, 21, 18, 23, 14, 14, 15, 19, 20, 14, 19, 24, 18, 20, 16, 17, 21, 20, 15, 20, 22, 24, 27, 21, 20, 15, 18, 19, 21, 16, 15, 19, 23, 19, 13, 16, 21, 18, 18, 16, 16, 22, 21, 19, 18, 22, 15, 19, 17, 21, 16, 20, 17, 12, 17, 15, 20, 14, 15, 13, 25, 22, 16, 22, 21, 21, 20, 16, 20, 16, 21, 19, 20, 20, 20, 25, 23, 17, 18, 13, 22, 19, 10, 21, 17, 21, 20, 27, 19, 15, 16, 20, 19, 22, 19, 19, 21, 18, 17, 20, 18, 21, 23, 20, 20, 18, 18, 24, 21, 17, 20, 20, 15, 17, 18, 19, 20, 17, 19, 18, 19, 17, 15, 22, 23, 21, 16, 15, 22, 23, 17, 19, 17, 18, 18, 17, 15, 25, 22, 20, 18, 22, 29, 21, 20, 17, 22, 25, 23, 29, 18, 13, 21, 18, 13, 21, 19, 21, 18, 19, 18, 27, 18, 22, 17, 19, 18, 15, 12, 15, 16, 17, 22, 19, 20, 23, 15, 22, 16, 18, 13, 17, 22, 10, 17, 23, 14, 14, 18, 20, 22, 24, 15, 14, 21, 21, 15, 23, 15, 20, 17, 15, 19, 21, 19, 22, 24, 19, 19, 18, 16, 22, 15, 17, 20, 12, 19, 21, 22, 15, 19, 15, 13, 15, 19, 27, 16, 19, 17, 17, 16, 17, 23, 14, 19, 22, 15, 20, 18, 23, 20, 23, 14, 17, 17, 19, 18, 14, 18, 18, 13, 20, 13, 20, 19, 21, 22, 21, 15, 18, 17, 14, 17, 15, 21, 23, 19, 14, 22, 16, 12, 15, 22, 16, 19, 21, 15, 19, 13, 19, 24, 15, 20, 15, 16, 12, 19, 23, 13, 20, 26, 20, 24, 17, 15, 13, 22, 21, 14, 20, 19, 22, 15, 20, 16, 17, 21, 17, 19, 15, 20, 14, 12, 19, 20, 20, 19, 13, 15, 21, 13, 21, 16, 18, 18, 17, 22, 16, 18, 18, 18, 16, 22, 23, 17, 16, 21, 20, 16, 19, 16, 22, 19, 18, 19, 22, 19, 18, 17, 16, 12, 21, 16, 25, 21, 20, 17, 17, 13, 17, 23, 12, 17, 14, 16, 22, 21, 16, 19, 15, 27, 16, 15, 14, 19, 13, 18, 18, 16, 21, 21, 20, 17, 18, 20, 20, 18, 15, 21, 12, 23, 18, 21, 23, 22, 23, 19, 15, 17, 14, 18, 20, 18, 16, 16, 17, 23, 19, 19, 25, 15, 21, 18, 19, 21, 17, 15, 23, 21, 17, 18, 18, 16, 11, 19, 22, 19, 12, 15, 14, 22, 17, 17, 18, 20, 15, 20, 22, 26, 19, 20, 26, 15, 14, 18, 16, 23, 19, 20, 19, 21, 15, 17, 20, 13, 16, 20, 20, 21, 16, 19, 20, 19, 22, 14, 18, 16, 16, 21, 24, 17, 23, 18, 15, 26, 17, 16, 15, 23, 22, 17, 23, 20, 19, 19, 23, 13, 14, 16, 17, 23, 22, 19, 21, 17, 21, 17, 18, 18, 16, 21, 21, 19, 21, 11, 18, 23, 16, 16, 18, 17, 18, 23, 23, 15, 11, 17, 20, 20, 18, 21, 20, 17, 16, 23, 19, 17, 14, 13, 15, 29, 17, 17, 15, 19, 17, 20, 13, 18, 18, 26, 22, 19, 19, 18, 17, 20, 17, 15, 26, 18, 18, 16, 18, 19, 20, 12, 18, 19, 16, 12, 12, 16, 20, 20, 22, 16, 18, 17, 18, 14, 20, 18, 19, 24, 17, 22, 24, 19, 20, 19, 10, 22, 18, 22, 16, 23, 25, 16, 17, 16, 18, 24, 25, 20, 24, 13, 19, 17, 19, 18, 20, 20, 21, 17, 18, 26, 21, 12, 15, 18, 18, 23, 22, 22, 18, 16, 20, 13, 14, 16, 15, 13, 17, 13, 18, 15, 16, 27, 22, 21, 16, 17, 22, 21, 21, 22, 17, 18, 23, 18, 21, 14, 21, 24, 17, 14, 21, 21, 19, 21, 21, 19, 15, 19, 21, 16, 18, 14, 23, 14, 17, 15, 13, 20, 21, 16, 24, 18, 8, 19, 17, 17, 17, 20, 21, 17, 20, 14, 22, 21, 18, 18, 21]

t_statistic, p_value = ttest_rel(trained_blocks, dummy_blocks[:len(trained_blocks)])

# Calculate the mean difference
mean_difference = np.mean(np.array(trained_blocks) - np.array(dummy_blocks[:len(trained_blocks)]))

# Calculate the standard error of the difference
std_error = np.std(np.array(trained_blocks) - np.array(dummy_blocks[:len(trained_blocks)]), ddof=1) / np.sqrt(len(trained_blocks))

# Calculate the confidence intervals
confidence_level = 0.95
degrees_freedom = len(trained_blocks) - 1
confidence_interval = t.interval(confidence_level, degrees_freedom, mean_difference, std_error)

print(f"Paired T-Test results: t-statistic = {t_statistic}, p-value = {p_value}")
print(f"Confidence interval: {confidence_interval}")

if p_value < 0.05:
    print("The difference between the trained model and the dummy model is statistically significant.")
else:
    print("The difference between the trained model and the dummy model is not statistically significant.")

# Paired T-Test results: t-statistic = 5.808870089050002, p-value = 1.6938206668063152e-06
# The difference between the trained model and the dummy model is statistically significant.
# Confidence interval: (898.0025827562124, 1866.115064302611)

import numpy as np
import matplotlib.pyplot as plt

# Your confidence interval
confidence_interval = (898.0025827562124, 1866.115064302611)

# Calculate the mean difference
mean_difference = np.mean(confidence_interval)

# Calculate the error (half the width of the confidence interval)
error = (confidence_interval[1] - confidence_interval[0]) / 2

# Create the plot
plt.figure(figsize=(8, 6))
plt.errorbar(1, mean_difference, yerr=error, fmt='o', color='b', ecolor='r', elinewidth=2, capsize=4)
plt.title('Confidence Interval for difference in average block per epoch')
plt.xlabel('')
plt.ylabel('Mean Difference (Blocks per epoch)')
plt.xlim(0, 2)  # Limit x-axis to focus on the error bar
plt.ylim(0, confidence_interval[1] + 200)  # Adjust y-axis to fit the error bar nicely
plt.grid(True)
plt.xticks([])  # Hide x-axis ticks as there's only one sample

# Add text to show the confidence interval values
plt.text(1, mean_difference + error + 50, f'CI: {confidence_interval}', ha='center', color='black')

plt.show()
